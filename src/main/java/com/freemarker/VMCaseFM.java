package com.freemarker;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;

import java.io.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * @author shennan
 * @date 2019/10/12 9:33
 */
public class VMCaseFM {
  public static Boolean startFlage = false;

  public static String old1 = "#macro( message $key )$TemVal.resource.getMessage($key, null, $TemVal.locale)#end";
  public static String new1 = "<#macro message code, locale>${loccalMessage.getMessage(code, locale)}</#macro>";
//
//  public static String old2 = "\'";
//  public static String new2 = "\"";
//
//  public static String old3 = "TemVal.";
//  public static String new3 = "";
//
//  public static String old4 = "$!";
//  public static String new4 = "$";
//
//  public static String old5 = "#if($!{TemVal.";
//  public static String new5 = "<#if ";
//
//  public static String old6 = "#elseif($!{TemVal.";
//  public static String new6 = "<#elseif ";
//
//  public static String old7 = ")";
//  public static String new7 = "/>";
//
////  public static String old8 = "}";
////  public static String new8 = "!''}";
//
//  public static String old9 = "#message(";
//  public static String new9 = "<@message locale=\"${locale}\" code=";
//
//  public static String old10 = "}==";
//  public static String new10 = "==";
//
//  public static String old11 = "\"Microsoft YaHei\"";
//  public static String new11 = "'Microsoft YaHei'";
//
//  public static String old12 = "|| ${";
//  public static String new12 = "|| ";

  public static String old13 = "#end";
  public static String new13 = "</#if>";

  public static String startCase(String oldStr ,String newStr ,String str){
//    for (int i = 0; i < 10; i++) {
    str = str.replace(oldStr,newStr);
//    }
    return  str;
  }

  public static String caseMessage(String content){
//    String content = "<body style=\"margin:0 auto; width:100%; font-size:10pt; color:#666666; font-family:'Microsoft YaHei',微软雅黑,Arial; \"bgcolor=\"#FFFFFF\"><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\" bgcolor=\"#FFFFFF\"><tbody><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#f7f7f7\" width=\"100%\"><imgstyle=\"width:600px;height:100px\" src=\"$!{TemVal.logo}\"/></td></tr></tbody></table></td></tr><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#EFEFEF\"><table cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px;\" width=\"580\"bgcolor=\"#FFFFFF\"><tr><td align=\"left\" colspan=\"2\"style=\"font-size:14pt; line-height:30px;\"><span style=\"margin-left:10px;\">#if($!{TemVal.value5}==1)#message('meeting.remind.message.mail.meeting_invite')#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.meeting_update_invite')#elseif($!{TemVal.value5}==3)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.meeting_reminder_appoint')#elseif($!{TemVal.value5}==6 || $!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_ack_appoint')#elseif($!{TemVal.value5}==8)#message('meeting.remind.message.mail.meeting_create_appoint')#elseif($!{TemVal.value5}==9)#message('meeting.remind.message.mail.meeting_update_appoint')#elseif($!{TemVal.value5}==10)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.tile')#elseif($!{TemVal.value5}==5 || $!{TemVal.value5}==11 || $!{TemVal.value5}==12 || $!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_appoint')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_title')#elseif($!{TemVal.value5}==99)#message('meeting.remind.message.mail.meeting_svc_notice')#elseif($!{TemVal.value5}==101 || $!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain_notice')#elseif($!{TemVal.value5}==103 || $!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible_notice')#elseif($!{TemVal.value5}==20 || $!{TemVal.value5}==21 || $!{TemVal.value5}==22 || $!{TemVal.value5}==23)#message('meeting.remind.message.mail.emailCancel.alarm.tile')#end</span></td></tr><tr><td colspan=\"2\" align=\"left\"style=\"font-size:12pt; line-height:30px;\">#if($!{TemVal.value5}!=15 && $!{TemVal.value5}!=17 && $!{TemVal.value5}!=20 && $!{TemVal.value5}!=21)<span style=\"margin-left:10px;\">#message('msg.email.content.invitUseSys.title.prefix')$!{TemVal.value4}#message('msg.email.content.invitUseSys.title.suffix')</span>#end</td></tr><tr><td align=\"left\" style=\"font-size:12pt; line-height:30px;\"><p class=\"k2\"style=\"margin-left:10px; text-indent: 35px; margin-top: 0px; margin-bottom: 10px;\">#if($!{TemVal.value5}==1)$!{TemVal.value6}#message('meeting.remind.message.mail.meeting.create.normal')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#if($!{TemVal.value29}==0)<a style=\"text-decoration: none;\"href=\"$!{TemVal.value15}\">#message('meeting.remind.message.mail.common.click.confirm')</a>#message('meeting.remind.message.mail.common.click.confirm.comma')#end#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==3)#if($!{TemVal.value28}==0)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.will.open.notice')$!{TemVal.value27}#message('meeting.remind.message.mail.meeting.will.open.prepare')#elseif($!{TemVal.value5}==5)#message('meeting.remind.message.mail.meeting_remove_appoint')#elseif($!{TemVal.value5}==6)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_atten_appoint')#elseif($!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_refus_appoint')#elseif($!{TemVal.value5}==8)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.recurring.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#else#message('meeting.remind.message.mail.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#end#elseif($!{TemVal.value5}==9)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==10)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end#if($!{TemVal.value28}==0)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==11)#message('meeting.remind.message.mail.meeting_audit_pass')#elseif($!{TemVal.value5}==12)#message('meeting.remind.message.mail.meeting_audit_refuse')#if($!{TemVal.value30}!=\"\")#message('meeting.remind.message.mail.meeting_audit_reason')$!{TemVal.value30}#message('meeting.remind.message.mail.meeting_audit_comma')#end#elseif($!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_audit_not')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\">#message('meeting.remind.message.mail.alarm.content.stop')</a>#message('meeting.remind.message.mail.alarm.content.or')<ahref=\"$!{TemVal.value24}\">#message('meeting.remind.message.mail.alarm.content.goon')</a>#message('meeting.remind.message.mail.alarm.content.end')#elseif($!{TemVal.value5}==16)#message('meeting.remind.message.mail.meeting.need.confirm')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\"style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff;margin-left: 5px; \">#message('meeting.remind.message.mail.alarm.content.stop')</a>#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.content1')#elseif($!{TemVal.value5}==20)#message('meeting.remind.message.mail.emailCancel.alarm.content')#elseif($!{TemVal.value5}==21)#message('meeting.remind.message.mail.autoCancel.alarm.content')#elseif($!{TemVal.value5}==22)#message('meeting.message.smsAndreserve.knd.startKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.startKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.startKeep3')#elseif($!{TemVal.value5}==23)#message('meeting.message.smsAndreserve.knd.rlsKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.rlsKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.rlsKeep3')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_need')#elseif($!{TemVal.value5}==99)[$!{TemVal.value7}]#message('meeting.remind.message.mail.clean.room_content')#elseif($!{TemVal.value5}==101)#message('meeting.remind.message.mail.maintain.content')#elseif($!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain.end.content')#elseif($!{TemVal.value5}==103)#message('meeting.remind.message.mail.visible.on.content')#elseif($!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible.off.nocontent')$!{TemVal.value30}#else#message('meeting.remind.message.mail.visible.off.content')#end</span></td><td align=\"right\" style=\"padding-right:5px;\">#if($!{TemVal.value5}==18)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value15}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.delay')</a></div>#elseif($!{TemVal.value14}!=\"\")#if($!{TemVal.value19}==0)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.start')</a></div>#elseif($!{TemVal.value19}==1)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.join')</a></div>#end#end</td></tr></table></td></tr></tbody></table></td></tr><tr valign=\"top\"><td colspan=\"2\" bgcolor=\"#EFEFEF\" style=\"padding: 0 10px 10px 10px;\"><table align=\"center\" valign=\"top\" cellspacing=\"0\" cellpadding=\"0\" width=\"580\"border=\"0\" bgcolor=\"#EFEFEF\"><tbody><tr valign=\"top\" align=\"center\"><td colspan=\"2\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-bottom:solid 1px #EFEFEF; border-top:1px solid #EFEFEF; border-collapse:collapse;background: #FFFFFF;\"width=\"580\"><tbody>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_subject')</td><td width=\"75%\"style=\"word-break:break-all\">$!{TemVal.value8}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_room')</td><td width=\"75%\">$!{TemVal.value7}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_startTime')</td><td width=\"75%\">$!{TemVal.value1} #message('msg.email.content.virsical.meeting_timezone')</td></tr>#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_mode')</td><td width=\"75%\">$!{TemVal.value32}</td></tr>#end#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_range')</td><td width=\"75%\">$!{TemVal.value33}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_endTime')</td><td width=\"75%\">$!{TemVal.value2} #message('msg.email.content.virsical.meeting_timezone')</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_creator')</td><td width=\"75%\">$!{TemVal.value6}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('meeting.remind.message.mail.meeting_host')</td><td width=\"75%\">$!{TemVal.value9}</td></tr>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_attendee')</td><td width=\"75%\">$!{TemVal.value10}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_remark')</td><td width=\"75%\">$!{TemVal.value11}</td></tr>#end#if($!{TemVal.value26}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_num')</td><td width=\"75%\">$!{TemVal.value26}</td></tr>#end#if($!{TemVal.value25}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_pwd')</td><td width=\"75%\">$!{TemVal.value25}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_loop')</td><td width=\"75%\">#if($!{TemVal.value12}==1)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_ordinary')</a>#elseif($!{TemVal.value12}==2)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>#elseif($!{TemVal.value12}==3)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==4)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==5)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#elseif($!{TemVal.value12}==6)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#end</td></tr>#end#if($!{TemVal.value21}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_inviteCode')</td><td width=\"75%\">$!{TemVal.value21}</td></tr>#end</tbody></table></td></tr><tr valign=\"top\" align=\"center\"><td colspan=\"2\" style=\"padding-bottom:10px;\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-collapse:collapse;background: #FFFFFF;\" width=\"580\"><tbody><tr><td colspan=\"2\"><span style=\"display:inline-block;margin:25px 0px 25px 60px;font-size:12pt;\">#message('msg.email.content.virsical.value7')</span></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";
    String pattern = "#message\\('[0-9a-zA-Z\\.\\_]+'\\)";
    String sssStart = "<@message code=\"";
    String sssEnd = "\" locale=\"${locale}\"/>";
    // 创建 Pattern 对象
    Pattern r = Pattern.compile(pattern);
    // 现在创建 matcher 对象
    Matcher m = r.matcher(content);
    while(m.find()) {
      String oldMessage = m.group(0);
      String key = oldMessage.substring(oldMessage.indexOf("'")+1,oldMessage.lastIndexOf("'"));
      String newMessage = sssStart+key+sssEnd;
      content = content.replace(oldMessage,newMessage);
    }
//    System.out.println(content);
    return content;

//    String list[] = {"{logo}","{imgPathBanner}","{imgPathDimcode}","{value1}","{value2}","{value3}","{value4}","{value5}","{value6}","{value7}","{value8}","{value9}","{value10}","{value11}","{value12}","{value13}","{value14}","{value15}","{value16}","{value17}","{value18}","{value19}","{value20}","{value21}","{value22}","{value23}","{value24}","value25","value26","value27","value28","value29","value30","value32","value32","value33","value34","{locale}","{imageDirectory}"};
////    String list[] = {"logo","imgPathBanner","imgPathDimcode","value1","value2","value3","value4","value5","value6","value7","value8","value9","value10","value11","value12","value13","value14","value15","value16","value17","value18","value19","value20","value21","value22","value23","value24","locale","imageDirectory"};
//    for (int i = 0; i <list.length ; i++) {
//      for (int j = 0; j < 10; j++) {
//        String strr  =list[i];
//        strr = strr.replace("}","!''}");
//        str = str.replace(list[i],strr);
//      }
//    }
//    return str;
  }


  public static String caseGetValue(String content){
//    String content = "<body style=\"margin:0 auto; width:100%; font-size:10pt; color:#666666; font-family:'Microsoft YaHei',微软雅黑,Arial; \"bgcolor=\"#FFFFFF\"><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\" bgcolor=\"#FFFFFF\"><tbody><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#f7f7f7\" width=\"100%\"><imgstyle=\"width:600px;height:100px\" src=\"$!{TemVal.logo}\"/></td></tr></tbody></table></td></tr><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#EFEFEF\"><table cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px;\" width=\"580\"bgcolor=\"#FFFFFF\"><tr><td align=\"left\" colspan=\"2\"style=\"font-size:14pt; line-height:30px;\"><span style=\"margin-left:10px;\">#if($!{TemVal.value5}==1)#message('meeting.remind.message.mail.meeting_invite')#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.meeting_update_invite')#elseif($!{TemVal.value5}==3)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.meeting_reminder_appoint')#elseif($!{TemVal.value5}==6 || $!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_ack_appoint')#elseif($!{TemVal.value5}==8)#message('meeting.remind.message.mail.meeting_create_appoint')#elseif($!{TemVal.value5}==9)#message('meeting.remind.message.mail.meeting_update_appoint')#elseif($!{TemVal.value5}==10)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.tile')#elseif($!{TemVal.value5}==5 || $!{TemVal.value5}==11 || $!{TemVal.value5}==12 || $!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_appoint')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_title')#elseif($!{TemVal.value5}==99)#message('meeting.remind.message.mail.meeting_svc_notice')#elseif($!{TemVal.value5}==101 || $!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain_notice')#elseif($!{TemVal.value5}==103 || $!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible_notice')#elseif($!{TemVal.value5}==20 || $!{TemVal.value5}==21 || $!{TemVal.value5}==22 || $!{TemVal.value5}==23)#message('meeting.remind.message.mail.emailCancel.alarm.tile')#end</span></td></tr><tr><td colspan=\"2\" align=\"left\"style=\"font-size:12pt; line-height:30px;\">#if($!{TemVal.value5}!=15 && $!{TemVal.value5}!=17 && $!{TemVal.value5}!=20 && $!{TemVal.value5}!=21)<span style=\"margin-left:10px;\">#message('msg.email.content.invitUseSys.title.prefix')$!{TemVal.value4}#message('msg.email.content.invitUseSys.title.suffix')</span>#end</td></tr><tr><td align=\"left\" style=\"font-size:12pt; line-height:30px;\"><p class=\"k2\"style=\"margin-left:10px; text-indent: 35px; margin-top: 0px; margin-bottom: 10px;\">#if($!{TemVal.value5}==1)$!{TemVal.value6}#message('meeting.remind.message.mail.meeting.create.normal')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#if($!{TemVal.value29}==0)<a style=\"text-decoration: none;\"href=\"$!{TemVal.value15}\">#message('meeting.remind.message.mail.common.click.confirm')</a>#message('meeting.remind.message.mail.common.click.confirm.comma')#end#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==3)#if($!{TemVal.value28}==0)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.will.open.notice')$!{TemVal.value27}#message('meeting.remind.message.mail.meeting.will.open.prepare')#elseif($!{TemVal.value5}==5)#message('meeting.remind.message.mail.meeting_remove_appoint')#elseif($!{TemVal.value5}==6)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_atten_appoint')#elseif($!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_refus_appoint')#elseif($!{TemVal.value5}==8)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.recurring.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#else#message('meeting.remind.message.mail.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#end#elseif($!{TemVal.value5}==9)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==10)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end#if($!{TemVal.value28}==0)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==11)#message('meeting.remind.message.mail.meeting_audit_pass')#elseif($!{TemVal.value5}==12)#message('meeting.remind.message.mail.meeting_audit_refuse')#if($!{TemVal.value30}!=\"\")#message('meeting.remind.message.mail.meeting_audit_reason')$!{TemVal.value30}#message('meeting.remind.message.mail.meeting_audit_comma')#end#elseif($!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_audit_not')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\">#message('meeting.remind.message.mail.alarm.content.stop')</a>#message('meeting.remind.message.mail.alarm.content.or')<ahref=\"$!{TemVal.value24}\">#message('meeting.remind.message.mail.alarm.content.goon')</a>#message('meeting.remind.message.mail.alarm.content.end')#elseif($!{TemVal.value5}==16)#message('meeting.remind.message.mail.meeting.need.confirm')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\"style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff;margin-left: 5px; \">#message('meeting.remind.message.mail.alarm.content.stop')</a>#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.content1')#elseif($!{TemVal.value5}==20)#message('meeting.remind.message.mail.emailCancel.alarm.content')#elseif($!{TemVal.value5}==21)#message('meeting.remind.message.mail.autoCancel.alarm.content')#elseif($!{TemVal.value5}==22)#message('meeting.message.smsAndreserve.knd.startKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.startKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.startKeep3')#elseif($!{TemVal.value5}==23)#message('meeting.message.smsAndreserve.knd.rlsKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.rlsKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.rlsKeep3')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_need')#elseif($!{TemVal.value5}==99)[$!{TemVal.value7}]#message('meeting.remind.message.mail.clean.room_content')#elseif($!{TemVal.value5}==101)#message('meeting.remind.message.mail.maintain.content')#elseif($!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain.end.content')#elseif($!{TemVal.value5}==103)#message('meeting.remind.message.mail.visible.on.content')#elseif($!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible.off.nocontent')$!{TemVal.value30}#else#message('meeting.remind.message.mail.visible.off.content')#end</span></td><td align=\"right\" style=\"padding-right:5px;\">#if($!{TemVal.value5}==18)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value15}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.delay')</a></div>#elseif($!{TemVal.value14}!=\"\")#if($!{TemVal.value19}==0)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.start')</a></div>#elseif($!{TemVal.value19}==1)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.join')</a></div>#end#end</td></tr></table></td></tr></tbody></table></td></tr><tr valign=\"top\"><td colspan=\"2\" bgcolor=\"#EFEFEF\" style=\"padding: 0 10px 10px 10px;\"><table align=\"center\" valign=\"top\" cellspacing=\"0\" cellpadding=\"0\" width=\"580\"border=\"0\" bgcolor=\"#EFEFEF\"><tbody><tr valign=\"top\" align=\"center\"><td colspan=\"2\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-bottom:solid 1px #EFEFEF; border-top:1px solid #EFEFEF; border-collapse:collapse;background: #FFFFFF;\"width=\"580\"><tbody>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_subject')</td><td width=\"75%\"style=\"word-break:break-all\">$!{TemVal.value8}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_room')</td><td width=\"75%\">$!{TemVal.value7}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_startTime')</td><td width=\"75%\">$!{TemVal.value1} #message('msg.email.content.virsical.meeting_timezone')</td></tr>#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_mode')</td><td width=\"75%\">$!{TemVal.value32}</td></tr>#end#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_range')</td><td width=\"75%\">$!{TemVal.value33}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_endTime')</td><td width=\"75%\">$!{TemVal.value2} #message('msg.email.content.virsical.meeting_timezone')</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_creator')</td><td width=\"75%\">$!{TemVal.value6}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('meeting.remind.message.mail.meeting_host')</td><td width=\"75%\">$!{TemVal.value9}</td></tr>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_attendee')</td><td width=\"75%\">$!{TemVal.value10}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_remark')</td><td width=\"75%\">$!{TemVal.value11}</td></tr>#end#if($!{TemVal.value26}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_num')</td><td width=\"75%\">$!{TemVal.value26}</td></tr>#end#if($!{TemVal.value25}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_pwd')</td><td width=\"75%\">$!{TemVal.value25}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_loop')</td><td width=\"75%\">#if($!{TemVal.value12}==1)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_ordinary')</a>#elseif($!{TemVal.value12}==2)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>#elseif($!{TemVal.value12}==3)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==4)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==5)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#elseif($!{TemVal.value12}==6)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#end</td></tr>#end#if($!{TemVal.value21}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_inviteCode')</td><td width=\"75%\">$!{TemVal.value21}</td></tr>#end</tbody></table></td></tr><tr valign=\"top\" align=\"center\"><td colspan=\"2\" style=\"padding-bottom:10px;\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-collapse:collapse;background: #FFFFFF;\" width=\"580\"><tbody><tr><td colspan=\"2\"><span style=\"display:inline-block;margin:25px 0px 25px 60px;font-size:12pt;\">#message('msg.email.content.virsical.value7')</span></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";
    String pattern = "\\$!\\{[\\[\\].\\{\\}\\(\\)\",0-9a-zA-Z\\.\\_]+\\}";
    String sssStart = "${";
    String sssEnd = "!''}";
    // 创建 Pattern 对象
    Pattern r = Pattern.compile(pattern);
    // 现在创建 matcher 对象
    Matcher m = r.matcher(content);
    while(m.find()) {
      String oldMessage = m.group(0);
      String key = oldMessage.substring(oldMessage.indexOf("$!{")+3,oldMessage.lastIndexOf("}"));
      key = key.replace("TemVal.","");
      String newMessage = sssStart+key+sssEnd;
//      System.out.println(newMessage);
      content = content.replace(oldMessage,newMessage);
    }
//    System.out.println(content);
    return content;

//    String list[] = {"{logo}","{imgPathBanner}","{imgPathDimcode}","{value1}","{value2}","{value3}","{value4}","{value5}","{value6}","{value7}","{value8}","{value9}","{value10}","{value11}","{value12}","{value13}","{value14}","{value15}","{value16}","{value17}","{value18}","{value19}","{value20}","{value21}","{value22}","{value23}","{value24}","value25","value26","value27","value28","value29","value30","value32","value32","value33","value34","{locale}","{imageDirectory}"};
////    String list[] = {"logo","imgPathBanner","imgPathDimcode","value1","value2","value3","value4","value5","value6","value7","value8","value9","value10","value11","value12","value13","value14","value15","value16","value17","value18","value19","value20","value21","value22","value23","value24","locale","imageDirectory"};
//    for (int i = 0; i <list.length ; i++) {
//      for (int j = 0; j < 10; j++) {
//        String strr  =list[i];
//        strr = strr.replace("}","!''}");
//        str = str.replace(list[i],strr);
//      }
//    }
//    return str;
  }

  public static String caseIf(String content,String pattern){
//    String content = "<body style=\"margin:0 auto; width:100%; font-size:10pt; color:#666666; font-family:'Microsoft YaHei',微软雅黑,Arial; \"bgcolor=\"#FFFFFF\"><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\" bgcolor=\"#FFFFFF\"><tbody><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#f7f7f7\" width=\"100%\"><imgstyle=\"width:600px;height:100px\" src=\"$!{TemVal.logo}\"/></td></tr></tbody></table></td></tr><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#EFEFEF\"><table cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px;\" width=\"580\"bgcolor=\"#FFFFFF\"><tr><td align=\"left\" colspan=\"2\"style=\"font-size:14pt; line-height:30px;\"><span style=\"margin-left:10px;\">#if($!{TemVal.value5}==1)#message('meeting.remind.message.mail.meeting_invite')#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.meeting_update_invite')#elseif($!{TemVal.value5}==3)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.meeting_reminder_appoint')#elseif($!{TemVal.value5}==6 || $!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_ack_appoint')#elseif($!{TemVal.value5}==8)#message('meeting.remind.message.mail.meeting_create_appoint')#elseif($!{TemVal.value5}==9)#message('meeting.remind.message.mail.meeting_update_appoint')#elseif($!{TemVal.value5}==10)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.tile')#elseif($!{TemVal.value5}==5 || $!{TemVal.value5}==11 || $!{TemVal.value5}==12 || $!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_appoint')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_title')#elseif($!{TemVal.value5}==99)#message('meeting.remind.message.mail.meeting_svc_notice')#elseif($!{TemVal.value5}==101 || $!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain_notice')#elseif($!{TemVal.value5}==103 || $!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible_notice')#elseif($!{TemVal.value5}==20 || $!{TemVal.value5}==21 || $!{TemVal.value5}==22 || $!{TemVal.value5}==23)#message('meeting.remind.message.mail.emailCancel.alarm.tile')#end</span></td></tr><tr><td colspan=\"2\" align=\"left\"style=\"font-size:12pt; line-height:30px;\">#if($!{TemVal.value5}!=15 && $!{TemVal.value5}!=17 && $!{TemVal.value5}!=20 && $!{TemVal.value5}!=21)<span style=\"margin-left:10px;\">#message('msg.email.content.invitUseSys.title.prefix')$!{TemVal.value4}#message('msg.email.content.invitUseSys.title.suffix')</span>#end</td></tr><tr><td align=\"left\" style=\"font-size:12pt; line-height:30px;\"><p class=\"k2\"style=\"margin-left:10px; text-indent: 35px; margin-top: 0px; margin-bottom: 10px;\">#if($!{TemVal.value5}==1)$!{TemVal.value6}#message('meeting.remind.message.mail.meeting.create.normal')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#if($!{TemVal.value29}==0)<a style=\"text-decoration: none;\"href=\"$!{TemVal.value15}\">#message('meeting.remind.message.mail.common.click.confirm')</a>#message('meeting.remind.message.mail.common.click.confirm.comma')#end#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==3)#if($!{TemVal.value28}==0)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.will.open.notice')$!{TemVal.value27}#message('meeting.remind.message.mail.meeting.will.open.prepare')#elseif($!{TemVal.value5}==5)#message('meeting.remind.message.mail.meeting_remove_appoint')#elseif($!{TemVal.value5}==6)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_atten_appoint')#elseif($!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_refus_appoint')#elseif($!{TemVal.value5}==8)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.recurring.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#else#message('meeting.remind.message.mail.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#end#elseif($!{TemVal.value5}==9)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==10)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end#if($!{TemVal.value28}==0)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==11)#message('meeting.remind.message.mail.meeting_audit_pass')#elseif($!{TemVal.value5}==12)#message('meeting.remind.message.mail.meeting_audit_refuse')#if($!{TemVal.value30}!=\"\")#message('meeting.remind.message.mail.meeting_audit_reason')$!{TemVal.value30}#message('meeting.remind.message.mail.meeting_audit_comma')#end#elseif($!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_audit_not')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\">#message('meeting.remind.message.mail.alarm.content.stop')</a>#message('meeting.remind.message.mail.alarm.content.or')<ahref=\"$!{TemVal.value24}\">#message('meeting.remind.message.mail.alarm.content.goon')</a>#message('meeting.remind.message.mail.alarm.content.end')#elseif($!{TemVal.value5}==16)#message('meeting.remind.message.mail.meeting.need.confirm')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\"style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff;margin-left: 5px; \">#message('meeting.remind.message.mail.alarm.content.stop')</a>#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.content1')#elseif($!{TemVal.value5}==20)#message('meeting.remind.message.mail.emailCancel.alarm.content')#elseif($!{TemVal.value5}==21)#message('meeting.remind.message.mail.autoCancel.alarm.content')#elseif($!{TemVal.value5}==22)#message('meeting.message.smsAndreserve.knd.startKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.startKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.startKeep3')#elseif($!{TemVal.value5}==23)#message('meeting.message.smsAndreserve.knd.rlsKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.rlsKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.rlsKeep3')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_need')#elseif($!{TemVal.value5}==99)[$!{TemVal.value7}]#message('meeting.remind.message.mail.clean.room_content')#elseif($!{TemVal.value5}==101)#message('meeting.remind.message.mail.maintain.content')#elseif($!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain.end.content')#elseif($!{TemVal.value5}==103)#message('meeting.remind.message.mail.visible.on.content')#elseif($!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible.off.nocontent')$!{TemVal.value30}#else#message('meeting.remind.message.mail.visible.off.content')#end</span></td><td align=\"right\" style=\"padding-right:5px;\">#if($!{TemVal.value5}==18)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value15}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.delay')</a></div>#elseif($!{TemVal.value14}!=\"\")#if($!{TemVal.value19}==0)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.start')</a></div>#elseif($!{TemVal.value19}==1)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.join')</a></div>#end#end</td></tr></table></td></tr></tbody></table></td></tr><tr valign=\"top\"><td colspan=\"2\" bgcolor=\"#EFEFEF\" style=\"padding: 0 10px 10px 10px;\"><table align=\"center\" valign=\"top\" cellspacing=\"0\" cellpadding=\"0\" width=\"580\"border=\"0\" bgcolor=\"#EFEFEF\"><tbody><tr valign=\"top\" align=\"center\"><td colspan=\"2\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-bottom:solid 1px #EFEFEF; border-top:1px solid #EFEFEF; border-collapse:collapse;background: #FFFFFF;\"width=\"580\"><tbody>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_subject')</td><td width=\"75%\"style=\"word-break:break-all\">$!{TemVal.value8}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_room')</td><td width=\"75%\">$!{TemVal.value7}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_startTime')</td><td width=\"75%\">$!{TemVal.value1} #message('msg.email.content.virsical.meeting_timezone')</td></tr>#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_mode')</td><td width=\"75%\">$!{TemVal.value32}</td></tr>#end#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_range')</td><td width=\"75%\">$!{TemVal.value33}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_endTime')</td><td width=\"75%\">$!{TemVal.value2} #message('msg.email.content.virsical.meeting_timezone')</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_creator')</td><td width=\"75%\">$!{TemVal.value6}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('meeting.remind.message.mail.meeting_host')</td><td width=\"75%\">$!{TemVal.value9}</td></tr>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_attendee')</td><td width=\"75%\">$!{TemVal.value10}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_remark')</td><td width=\"75%\">$!{TemVal.value11}</td></tr>#end#if($!{TemVal.value26}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_num')</td><td width=\"75%\">$!{TemVal.value26}</td></tr>#end#if($!{TemVal.value25}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_pwd')</td><td width=\"75%\">$!{TemVal.value25}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_loop')</td><td width=\"75%\">#if($!{TemVal.value12}==1)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_ordinary')</a>#elseif($!{TemVal.value12}==2)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>#elseif($!{TemVal.value12}==3)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==4)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==5)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#elseif($!{TemVal.value12}==6)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#end</td></tr>#end#if($!{TemVal.value21}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_inviteCode')</td><td width=\"75%\">$!{TemVal.value21}</td></tr>#end</tbody></table></td></tr><tr valign=\"top\" align=\"center\"><td colspan=\"2\" style=\"padding-bottom:10px;\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-collapse:collapse;background: #FFFFFF;\" width=\"580\"><tbody><tr><td colspan=\"2\"><span style=\"display:inline-block;margin:25px 0px 25px 60px;font-size:12pt;\">#message('msg.email.content.virsical.value7')</span></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";
//    pattern = "#if\\([\\$\\!\\{\\}\\=0-9a-zA-Z\\.\\_]+\\)";
    String sssStart = "<#if ";
    String sssEnd = ">";
    // 创建 Pattern 对象
    Pattern r = Pattern.compile(pattern);
    // 现在创建 matcher 对象
    Matcher m = r.matcher(content);
    while(m.find()) {
      String oldMessage = m.group(0);
      String key = oldMessage.substring(oldMessage.indexOf("#if(")+4,oldMessage.lastIndexOf(")"));
      key= key.replaceAll("!''","");
      key= key.replaceAll("\\$\\{","");
      key= key.replaceAll("}","");
      if ((key.contains("==") || key.contains("!=") ) && !key.contains("\"") && !key.contains("'")){
        key= key.replaceAll("==","=='");
        key= key.replaceAll("!=","!='");
        key= key.replaceAll(" &&","' &&");
        key= key.replaceAll(" \\|\\|","' \\|\\|");
        key  = key+"'";
      }
      String newMessage = sssStart+key+sssEnd;
      content = content.replace(oldMessage,newMessage);
    }
//    System.out.println(content);
    return content;

//    String list[] = {"{logo}","{imgPathBanner}","{imgPathDimcode}","{value1}","{value2}","{value3}","{value4}","{value5}","{value6}","{value7}","{value8}","{value9}","{value10}","{value11}","{value12}","{value13}","{value14}","{value15}","{value16}","{value17}","{value18}","{value19}","{value20}","{value21}","{value22}","{value23}","{value24}","value25","value26","value27","value28","value29","value30","value32","value32","value33","value34","{locale}","{imageDirectory}"};
////    String list[] = {"logo","imgPathBanner","imgPathDimcode","value1","value2","value3","value4","value5","value6","value7","value8","value9","value10","value11","value12","value13","value14","value15","value16","value17","value18","value19","value20","value21","value22","value23","value24","locale","imageDirectory"};
//    for (int i = 0; i <list.length ; i++) {
//      for (int j = 0; j < 10; j++) {
//        String strr  =list[i];
//        strr = strr.replace("}","!''}");
//        str = str.replace(list[i],strr);
//      }
//    }
//    return str;
  }

  public static String caseElseIf(String content){
//    content = "<body style=\"margin:0 auto; width:100%; font-size:10pt; color:#666666; font-family:'Microsoft YaHei',微软雅黑,Arial; \"bgcolor=\"#FFFFFF\"><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\" bgcolor=\"#FFFFFF\"><tbody><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#f7f7f7\" width=\"100%\"><imgstyle=\"width:600px;height:100px\" src=\"$!{TemVal.logo}\"/></td></tr></tbody></table></td></tr><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#EFEFEF\"><table cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px;\" width=\"580\"bgcolor=\"#FFFFFF\"><tr><td align=\"left\" colspan=\"2\"style=\"font-size:14pt; line-height:30px;\"><span style=\"margin-left:10px;\">#if($!{TemVal.value5}==1)#message('meeting.remind.message.mail.meeting_invite')#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.meeting_update_invite')#elseif($!{TemVal.value5}==3)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.meeting_reminder_appoint')#elseif($!{TemVal.value5}==6 || $!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_ack_appoint')#elseif($!{TemVal.value5}==8)#message('meeting.remind.message.mail.meeting_create_appoint')#elseif($!{TemVal.value5}==9)#message('meeting.remind.message.mail.meeting_update_appoint')#elseif($!{TemVal.value5}==10)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.tile')#elseif($!{TemVal.value5}==5 || $!{TemVal.value5}==11 || $!{TemVal.value5}==12 || $!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_appoint')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_title')#elseif($!{TemVal.value5}==99)#message('meeting.remind.message.mail.meeting_svc_notice')#elseif($!{TemVal.value5}==101 || $!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain_notice')#elseif($!{TemVal.value5}==103 || $!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible_notice')#elseif($!{TemVal.value5}==20 || $!{TemVal.value5}==21 || $!{TemVal.value5}==22 || $!{TemVal.value5}==23)#message('meeting.remind.message.mail.emailCancel.alarm.tile')#end</span></td></tr><tr><td colspan=\"2\" align=\"left\"style=\"font-size:12pt; line-height:30px;\">#if($!{TemVal.value5}!=15 && $!{TemVal.value5}!=17 && $!{TemVal.value5}!=20 && $!{TemVal.value5}!=21)<span style=\"margin-left:10px;\">#message('msg.email.content.invitUseSys.title.prefix')$!{TemVal.value4}#message('msg.email.content.invitUseSys.title.suffix')</span>#end</td></tr><tr><td align=\"left\" style=\"font-size:12pt; line-height:30px;\"><p class=\"k2\"style=\"margin-left:10px; text-indent: 35px; margin-top: 0px; margin-bottom: 10px;\">#if($!{TemVal.value5}==1)$!{TemVal.value6}#message('meeting.remind.message.mail.meeting.create.normal')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#if($!{TemVal.value29}==0)<a style=\"text-decoration: none;\"href=\"$!{TemVal.value15}\">#message('meeting.remind.message.mail.common.click.confirm')</a>#message('meeting.remind.message.mail.common.click.confirm.comma')#end#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==3)#if($!{TemVal.value28}==0)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.will.open.notice')$!{TemVal.value27}#message('meeting.remind.message.mail.meeting.will.open.prepare')#elseif($!{TemVal.value5}==5)#message('meeting.remind.message.mail.meeting_remove_appoint')#elseif($!{TemVal.value5}==6)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_atten_appoint')#elseif($!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_refus_appoint')#elseif($!{TemVal.value5}==8)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.recurring.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#else#message('meeting.remind.message.mail.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#end#elseif($!{TemVal.value5}==9)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==10)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end#if($!{TemVal.value28}==0)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==11)#message('meeting.remind.message.mail.meeting_audit_pass')#elseif($!{TemVal.value5}==12)#message('meeting.remind.message.mail.meeting_audit_refuse')#if($!{TemVal.value30}!=\"\")#message('meeting.remind.message.mail.meeting_audit_reason')$!{TemVal.value30}#message('meeting.remind.message.mail.meeting_audit_comma')#end#elseif($!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_audit_not')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\">#message('meeting.remind.message.mail.alarm.content.stop')</a>#message('meeting.remind.message.mail.alarm.content.or')<ahref=\"$!{TemVal.value24}\">#message('meeting.remind.message.mail.alarm.content.goon')</a>#message('meeting.remind.message.mail.alarm.content.end')#elseif($!{TemVal.value5}==16)#message('meeting.remind.message.mail.meeting.need.confirm')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\"style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff;margin-left: 5px; \">#message('meeting.remind.message.mail.alarm.content.stop')</a>#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.content1')#elseif($!{TemVal.value5}==20)#message('meeting.remind.message.mail.emailCancel.alarm.content')#elseif($!{TemVal.value5}==21)#message('meeting.remind.message.mail.autoCancel.alarm.content')#elseif($!{TemVal.value5}==22)#message('meeting.message.smsAndreserve.knd.startKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.startKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.startKeep3')#elseif($!{TemVal.value5}==23)#message('meeting.message.smsAndreserve.knd.rlsKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.rlsKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.rlsKeep3')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_need')#elseif($!{TemVal.value5}==99)[$!{TemVal.value7}]#message('meeting.remind.message.mail.clean.room_content')#elseif($!{TemVal.value5}==101)#message('meeting.remind.message.mail.maintain.content')#elseif($!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain.end.content')#elseif($!{TemVal.value5}==103)#message('meeting.remind.message.mail.visible.on.content')#elseif($!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible.off.nocontent')$!{TemVal.value30}#else#message('meeting.remind.message.mail.visible.off.content')#end</span></td><td align=\"right\" style=\"padding-right:5px;\">#if($!{TemVal.value5}==18)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value15}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.delay')</a></div>#elseif($!{TemVal.value14}!=\"\")#if($!{TemVal.value19}==0)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.start')</a></div>#elseif($!{TemVal.value19}==1)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.join')</a></div>#end#end</td></tr></table></td></tr></tbody></table></td></tr><tr valign=\"top\"><td colspan=\"2\" bgcolor=\"#EFEFEF\" style=\"padding: 0 10px 10px 10px;\"><table align=\"center\" valign=\"top\" cellspacing=\"0\" cellpadding=\"0\" width=\"580\"border=\"0\" bgcolor=\"#EFEFEF\"><tbody><tr valign=\"top\" align=\"center\"><td colspan=\"2\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-bottom:solid 1px #EFEFEF; border-top:1px solid #EFEFEF; border-collapse:collapse;background: #FFFFFF;\"width=\"580\"><tbody>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_subject')</td><td width=\"75%\"style=\"word-break:break-all\">$!{TemVal.value8}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_room')</td><td width=\"75%\">$!{TemVal.value7}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_startTime')</td><td width=\"75%\">$!{TemVal.value1} #message('msg.email.content.virsical.meeting_timezone')</td></tr>#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_mode')</td><td width=\"75%\">$!{TemVal.value32}</td></tr>#end#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_range')</td><td width=\"75%\">$!{TemVal.value33}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_endTime')</td><td width=\"75%\">$!{TemVal.value2} #message('msg.email.content.virsical.meeting_timezone')</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_creator')</td><td width=\"75%\">$!{TemVal.value6}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('meeting.remind.message.mail.meeting_host')</td><td width=\"75%\">$!{TemVal.value9}</td></tr>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_attendee')</td><td width=\"75%\">$!{TemVal.value10}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_remark')</td><td width=\"75%\">$!{TemVal.value11}</td></tr>#end#if($!{TemVal.value26}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_num')</td><td width=\"75%\">$!{TemVal.value26}</td></tr>#end#if($!{TemVal.value25}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_pwd')</td><td width=\"75%\">$!{TemVal.value25}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_loop')</td><td width=\"75%\">#if($!{TemVal.value12}==1)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_ordinary')</a>#elseif($!{TemVal.value12}==2)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>#elseif($!{TemVal.value12}==3)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==4)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==5)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#elseif($!{TemVal.value12}==6)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#end</td></tr>#end#if($!{TemVal.value21}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_inviteCode')</td><td width=\"75%\">$!{TemVal.value21}</td></tr>#end</tbody></table></td></tr><tr valign=\"top\" align=\"center\"><td colspan=\"2\" style=\"padding-bottom:10px;\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-collapse:collapse;background: #FFFFFF;\" width=\"580\"><tbody><tr><td colspan=\"2\"><span style=\"display:inline-block;margin:25px 0px 25px 60px;font-size:12pt;\">#message('msg.email.content.virsical.value7')</span></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";
    String  pattern = "#elseif\\([\\| \\'\\&\\$\\!\\{\\}\\=0-9a-zA-Z\\.\\_]+\\)";
    String sssStart = "<#elseif ";
    String sssEnd = ">";
    // 创建 Pattern 对象
    Pattern r = Pattern.compile(pattern);
    // 现在创建 matcher 对象
    Matcher m = r.matcher(content);
    while(m.find()) {
      String oldMessage = m.group(0);
//      System.out.println(oldMessage);
      String key = oldMessage.substring(oldMessage.indexOf("#elseif(")+8,oldMessage.lastIndexOf(")"));
      key= key.replaceAll("!''","");
      key= key.replaceAll("\\$\\{","");
      key= key.replaceAll("}","");
      if ((key.contains("==") || key.contains("!=") ) && !key.contains("\"") && !key.contains("'")){
        key= key.replaceAll("==","=='");
        key= key.replaceAll("!=","!='");
        key= key.replaceAll(" &&","' &&");
        key= key.replaceAll(" \\|\\|","' \\|\\|");
        key  = key+"'";
      }

      String newMessage = sssStart+key+sssEnd;
//      System.out.println(newMessage);
      content = content.replace(oldMessage,newMessage);
    }
//    System.out.println(content);
    return content;

//    String list[] = {"{logo}","{imgPathBanner}","{imgPathDimcode}","{value1}","{value2}","{value3}","{value4}","{value5}","{value6}","{value7}","{value8}","{value9}","{value10}","{value11}","{value12}","{value13}","{value14}","{value15}","{value16}","{value17}","{value18}","{value19}","{value20}","{value21}","{value22}","{value23}","{value24}","value25","value26","value27","value28","value29","value30","value32","value32","value33","value34","{locale}","{imageDirectory}"};
////    String list[] = {"logo","imgPathBanner","imgPathDimcode","value1","value2","value3","value4","value5","value6","value7","value8","value9","value10","value11","value12","value13","value14","value15","value16","value17","value18","value19","value20","value21","value22","value23","value24","locale","imageDirectory"};
//    for (int i = 0; i <list.length ; i++) {
//      for (int j = 0; j < 10; j++) {
//        String strr  =list[i];
//        strr = strr.replace("}","!''}");
//        str = str.replace(list[i],strr);
//      }
//    }
//    return str;
  }


  public static String caseElseIf1(String content){
//    content = "<body style=\"margin:0 auto; width:100%; font-size:10pt; color:#666666; font-family:'Microsoft YaHei',微软雅黑,Arial; \"bgcolor=\"#FFFFFF\"><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\" bgcolor=\"#FFFFFF\"><tbody><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#f7f7f7\" width=\"100%\"><imgstyle=\"width:600px;height:100px\" src=\"$!{TemVal.logo}\"/></td></tr></tbody></table></td></tr><tr><td colspan=\"2\"><table align=\"center\" class=\"banner\" cellspacing=\"0\" cellpadding=\"0\" width=\"600\"height=\"100\"><tbody><tr><td colspan=\"2\" bgcolor=\"#EFEFEF\"><table cellpadding=\"0\" cellspacing=\"0\" style=\"margin:10px;\" width=\"580\"bgcolor=\"#FFFFFF\"><tr><td align=\"left\" colspan=\"2\"style=\"font-size:14pt; line-height:30px;\"><span style=\"margin-left:10px;\">#if($!{TemVal.value5}==1)#message('meeting.remind.message.mail.meeting_invite')#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.meeting_update_invite')#elseif($!{TemVal.value5}==3)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.meeting_reminder_appoint')#elseif($!{TemVal.value5}==6 || $!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_ack_appoint')#elseif($!{TemVal.value5}==8)#message('meeting.remind.message.mail.meeting_create_appoint')#elseif($!{TemVal.value5}==9)#message('meeting.remind.message.mail.meeting_update_appoint')#elseif($!{TemVal.value5}==10)#message('meeting.remind.message.mail.meeting_cancel_appoint')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.tile')#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.tile')#elseif($!{TemVal.value5}==5 || $!{TemVal.value5}==11 || $!{TemVal.value5}==12 || $!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_appoint')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_title')#elseif($!{TemVal.value5}==99)#message('meeting.remind.message.mail.meeting_svc_notice')#elseif($!{TemVal.value5}==101 || $!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain_notice')#elseif($!{TemVal.value5}==103 || $!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible_notice')#elseif($!{TemVal.value5}==20 || $!{TemVal.value5}==21 || $!{TemVal.value5}==22 || $!{TemVal.value5}==23)#message('meeting.remind.message.mail.emailCancel.alarm.tile')#end</span></td></tr><tr><td colspan=\"2\" align=\"left\"style=\"font-size:12pt; line-height:30px;\">#if($!{TemVal.value5}!=15 && $!{TemVal.value5}!=17 && $!{TemVal.value5}!=20 && $!{TemVal.value5}!=21)<span style=\"margin-left:10px;\">#message('msg.email.content.invitUseSys.title.prefix')$!{TemVal.value4}#message('msg.email.content.invitUseSys.title.suffix')</span>#end</td></tr><tr><td align=\"left\" style=\"font-size:12pt; line-height:30px;\"><p class=\"k2\"style=\"margin-left:10px; text-indent: 35px; margin-top: 0px; margin-bottom: 10px;\">#if($!{TemVal.value5}==1)$!{TemVal.value6}#message('meeting.remind.message.mail.meeting.create.normal')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#if($!{TemVal.value29}==0)<a style=\"text-decoration: none;\"href=\"$!{TemVal.value15}\">#message('meeting.remind.message.mail.common.click.confirm')</a>#message('meeting.remind.message.mail.common.click.confirm.comma')#end#elseif($!{TemVal.value5}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==3)#if($!{TemVal.value28}==0)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==4)#message('meeting.remind.message.mail.common.your')[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.will.open.notice')$!{TemVal.value27}#message('meeting.remind.message.mail.meeting.will.open.prepare')#elseif($!{TemVal.value5}==5)#message('meeting.remind.message.mail.meeting_remove_appoint')#elseif($!{TemVal.value5}==6)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_atten_appoint')#elseif($!{TemVal.value5}==7)#message('meeting.remind.message.mail.meeting_attendee')$!{TemVal.value13} #message('meeting.remind.message.mail.meeting_confirm_refus_appoint')#elseif($!{TemVal.value5}==8)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.recurring.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#else#message('meeting.remind.message.mail.meeting.create.succ')$!{TemVal.value27}，#message('meeting.remind.message.mail.meeting.create.succ.in')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.create.succ.open')#end#elseif($!{TemVal.value5}==9)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.update.succ.notice')#elseif($!{TemVal.value5}==10)#if($!{TemVal.value32}!=\"\")#message('meeting.remind.message.mail.common.recurringmeeting')#else#message('meeting.remind.message.mail.common.your')#end#if($!{TemVal.value28}==0)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.cancel.succ.notice')#elseif($!{TemVal.value28}==1)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.sign')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==2)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.not.accept')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==3)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.maintain')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#elseif($!{TemVal.value28}==4)[$!{TemVal.value8}]#message('meeting.remind.message.mail.meeting.has.unvisible')$!{TemVal.value7}#message('meeting.remind.message.mail.meeting.release.succ.notice')#end#elseif($!{TemVal.value5}==11)#message('meeting.remind.message.mail.meeting_audit_pass')#elseif($!{TemVal.value5}==12)#message('meeting.remind.message.mail.meeting_audit_refuse')#if($!{TemVal.value30}!=\"\")#message('meeting.remind.message.mail.meeting_audit_reason')$!{TemVal.value30}#message('meeting.remind.message.mail.meeting_audit_comma')#end#elseif($!{TemVal.value5}==13)#message('meeting.remind.message.mail.meeting_audit_not')#elseif($!{TemVal.value5}==15)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\">#message('meeting.remind.message.mail.alarm.content.stop')</a>#message('meeting.remind.message.mail.alarm.content.or')<ahref=\"$!{TemVal.value24}\">#message('meeting.remind.message.mail.alarm.content.goon')</a>#message('meeting.remind.message.mail.alarm.content.end')#elseif($!{TemVal.value5}==16)#message('meeting.remind.message.mail.meeting.need.confirm')#elseif($!{TemVal.value5}==17)#message('meeting.remind.message.mail.alarm.content')<ahref=\"$!{TemVal.value23}\"style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff;margin-left: 5px; \">#message('meeting.remind.message.mail.alarm.content.stop')</a>#elseif($!{TemVal.value5}==18)#message('meeting.remind.message.mail.willend.content1')#elseif($!{TemVal.value5}==20)#message('meeting.remind.message.mail.emailCancel.alarm.content')#elseif($!{TemVal.value5}==21)#message('meeting.remind.message.mail.autoCancel.alarm.content')#elseif($!{TemVal.value5}==22)#message('meeting.message.smsAndreserve.knd.startKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.startKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.startKeep3')#elseif($!{TemVal.value5}==23)#message('meeting.message.smsAndreserve.knd.rlsKeep1')$!{TemVal.value7}#message('meeting.message.smsAndreserve.knd.rlsKeep2')$!{TemVal.value31}#message('meeting.message.smsAndreserve.knd.rlsKeep3')#elseif($!{TemVal.value5}==66)#message('meeting.remind.message.mail.meeting_audit_need')#elseif($!{TemVal.value5}==99)[$!{TemVal.value7}]#message('meeting.remind.message.mail.clean.room_content')#elseif($!{TemVal.value5}==101)#message('meeting.remind.message.mail.maintain.content')#elseif($!{TemVal.value5}==102)#message('meeting.remind.message.mail.maintain.end.content')#elseif($!{TemVal.value5}==103)#message('meeting.remind.message.mail.visible.on.content')#elseif($!{TemVal.value5}==104)#message('meeting.remind.message.mail.visible.off.nocontent')$!{TemVal.value30}#else#message('meeting.remind.message.mail.visible.off.content')#end</span></td><td align=\"right\" style=\"padding-right:5px;\">#if($!{TemVal.value5}==18)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value15}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.delay')</a></div>#elseif($!{TemVal.value14}!=\"\")#if($!{TemVal.value19}==0)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.start')</a></div>#elseif($!{TemVal.value19}==1)<div style=\"width: 75px;\"><a href=\"$!{TemVal.value14}\" style=\"line-height: 15px; border-radius:5px; padding:5px 10px; text-decoration:none; font-size:10pt; background:#0467BA; color:#ffffff; \">#message('msg.email.content.virsical.join')</a></div>#end#end</td></tr></table></td></tr></tbody></table></td></tr><tr valign=\"top\"><td colspan=\"2\" bgcolor=\"#EFEFEF\" style=\"padding: 0 10px 10px 10px;\"><table align=\"center\" valign=\"top\" cellspacing=\"0\" cellpadding=\"0\" width=\"580\"border=\"0\" bgcolor=\"#EFEFEF\"><tbody><tr valign=\"top\" align=\"center\"><td colspan=\"2\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-bottom:solid 1px #EFEFEF; border-top:1px solid #EFEFEF; border-collapse:collapse;background: #FFFFFF;\"width=\"580\"><tbody>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_subject')</td><td width=\"75%\"style=\"word-break:break-all\">$!{TemVal.value8}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_room')</td><td width=\"75%\">$!{TemVal.value7}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_startTime')</td><td width=\"75%\">$!{TemVal.value1} #message('msg.email.content.virsical.meeting_timezone')</td></tr>#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_mode')</td><td width=\"75%\">$!{TemVal.value32}</td></tr>#end#if($!{TemVal.value32}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_regular_range')</td><td width=\"75%\">$!{TemVal.value33}</td></tr>#end<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_endTime')</td><td width=\"75%\">$!{TemVal.value2} #message('msg.email.content.virsical.meeting_timezone')</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_creator')</td><td width=\"75%\">$!{TemVal.value6}</td></tr><tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('meeting.remind.message.mail.meeting_host')</td><td width=\"75%\">$!{TemVal.value9}</td></tr>#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_attendee')</td><td width=\"75%\">$!{TemVal.value10}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_remark')</td><td width=\"75%\">$!{TemVal.value11}</td></tr>#end#if($!{TemVal.value26}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_num')</td><td width=\"75%\">$!{TemVal.value26}</td></tr>#end#if($!{TemVal.value25}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_pwd')</td><td width=\"75%\">$!{TemVal.value25}</td></tr>#end#if($!{TemVal.value5} != 99)<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_loop')</td><td width=\"75%\">#if($!{TemVal.value12}==1)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_ordinary')</a>#elseif($!{TemVal.value12}==2)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>#elseif($!{TemVal.value12}==3)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==4)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_webex')</a>#elseif($!{TemVal.value12}==5)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#elseif($!{TemVal.value12}==6)<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #baddff; \">#message('meeting.remind.message.mail.meeting_label_loop')</a>&nbsp;&nbsp;&nbsp;&nbsp;<a style=\"line-height: 15px; border-radius:5px; padding:5px; text-decoration:none; font-size:9pt; border:1px solid #c0e4c5; \">#message('meeting.remind.message.mail.meeting_label_video')</a>#end</td></tr>#end#if($!{TemVal.value21}!=\"\")<tr><td align=\"right\" style=\"color:#b4b4b4;\" width=\"25%\">#message('msg.email.content.virsical.meeting_inviteCode')</td><td width=\"75%\">$!{TemVal.value21}</td></tr>#end</tbody></table></td></tr><tr valign=\"top\" align=\"center\"><td colspan=\"2\" style=\"padding-bottom:10px;\"><table cellpadding=\"10\" cellspacing=\"0\"style=\"border-collapse:collapse;background: #FFFFFF;\" width=\"580\"><tbody><tr><td colspan=\"2\"><span style=\"display:inline-block;margin:25px 0px 25px 60px;font-size:12pt;\">#message('msg.email.content.virsical.value7')</span></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";
    String  pattern = "#elseif[\\| \\'\\$\\!\\{\\}\\=0-9a-zA-Z\\.\\_]+\\)";
    String sssStart = "<#elseif ";
    String sssEnd = ">";
    // 创建 Pattern 对象
    Pattern r = Pattern.compile(pattern);
    // 现在创建 matcher 对象
    Matcher m = r.matcher(content);
    while(m.find()) {
      String oldMessage = m.group(0);
//      System.out.println(oldMessage);
      String key = oldMessage.substring(oldMessage.indexOf("#elseif ")+8,oldMessage.lastIndexOf(")"));
      key= key.replaceAll("!''","");
      key= key.replaceAll("\\$\\{","");
      key= key.replaceAll("}","");
      String newMessage = sssStart+key+sssEnd;
//      System.out.println(newMessage);
      content = content.replace(oldMessage,newMessage);
    }
//    System.out.println(content);
    return content;

//    String list[] = {"{logo}","{imgPathBanner}","{imgPathDimcode}","{value1}","{value2}","{value3}","{value4}","{value5}","{value6}","{value7}","{value8}","{value9}","{value10}","{value11}","{value12}","{value13}","{value14}","{value15}","{value16}","{value17}","{value18}","{value19}","{value20}","{value21}","{value22}","{value23}","{value24}","value25","value26","value27","value28","value29","value30","value32","value32","value33","value34","{locale}","{imageDirectory}"};
////    String list[] = {"logo","imgPathBanner","imgPathDimcode","value1","value2","value3","value4","value5","value6","value7","value8","value9","value10","value11","value12","value13","value14","value15","value16","value17","value18","value19","value20","value21","value22","value23","value24","locale","imageDirectory"};
//    for (int i = 0; i <list.length ; i++) {
//      for (int j = 0; j < 10; j++) {
//        String strr  =list[i];
//        strr = strr.replace("}","!''}");
//        str = str.replace(list[i],strr);
//      }
//    }
//    return str;
  }


  public static String caseLine(String str){
//    if (str.contains(old1)){
//      return startCase(old1 ,new1,str);
//    }

//    int i = str.indexOf(">");
//    String bodyStr = str.substring(0,i+1);


    str = caseMessage(str);
    str = caseGetValue(str);
    str = str.replaceAll("elseif","888888888888888888888");
    str = str.replaceAll("#else","<#else>");
    str = str.replaceAll("888888888888888888888","elseif");
    str = caseIf(str,"#if\\([\\| '\\&\\$\\!\\\"\\{\\}\\=0-9a-zA-Z\\.\\_]+\\)");
    str = caseElseIf(str);
//    str = caseElseIf1(str);
//    str = caseIf(str,"#else\\([\\$\\!\\{\\}\\=0-9a-zA-Z\\.\\_]+\\)");

//    str = startCase(old13 ,new13,str);
//    Document doc = Jsoup.parseBodyFragment(str);
//    str = doc.body().html();
//    str = str.replaceAll("&lt;","<");
//    str = str.replaceAll("&gt;",">");
//    str = str.replaceAll("#else","<#else>");
//    str = str.replaceAll("\n","\r\n");

    StringBuilder sbb = new StringBuilder();
    str = str.replaceAll(old13, new13);
//    str = bodyStr+"\r\n"+str;

    //格式化
    char[] chars = str.toCharArray();
    int x = 0;
    for (int j = 0; j < chars.length; j++) {
      char aChar = chars[j];
      if (aChar=='/'){
        x=x-2;
//        for (int k = 0; k < x; k++) {
//          sbb.append("\t");
//        }
        sbb.append(aChar);
      }else if(aChar=='<'){
        sbb.append("\r\n");
        x=x+1;
        for (int k = 0; k < x; k++) {
          sbb.append(" ");
        }
        sbb.append(aChar);
      }else{
        sbb.append(aChar);
      }
    }


//    System.out.println(str);
//    str = startCase(old5 ,new5,str);
//    str = startCase(old6 ,new6,str);
//    str = startCase(old2 ,new2,str);
//    str = startCase(old3 ,new3,str);
//    str = startCase(old4 ,new4,str);
//    str = startCase(old7 ,new7,str);
////    str = startCase(old8 ,new8,str);
//    str = startCase(old10 ,new10,str);
//    str = startCase(old9 ,new9,str);
//    str = startCase(old11 ,new11,str);
//    str = startCase(old12 ,new12,str);


    return sbb.toString();
  }

  public static String caseFile(File file){

//    String str = FileUtil.readString(file,"utf-8");
//    Document doc = Jsoup.parseBodyFragment(str);
//
//    str = doc.body().html();
//    FileUtil.writeString(str,"C:\\Users\\wafer\\Desktop\\templates-new\\"+file.getName(),"utf-8");
//    return str;
    if (file.getName().equals("smtMeeting.vm")){
//      System.out.println(1234);
    }
    System.out.println("开始转换文件"+file.getName());
    BufferedReader br = null;
    try {
      br = new BufferedReader(new FileReader(file));
      String str = "";
      StringBuilder sb = new StringBuilder();
      StringBuilder sb1 = new StringBuilder();
      while ((str = br.readLine()) != null){
        if (str.contains(old1)){
          sb.append(startCase(old1 ,new1,str)+"\r\n");
          continue;
        }
        if (str.trim().contains("<body")){
          startFlage = true;
        }
        if (str.trim().contains("</body>")){

          sb.append(caseLine(sb1.toString())+"\r\n");
          sb.append(str.trim()+"\r\n");
          startFlage = false;
          continue;
        }

        if (startFlage){
          String trim = str.trim();
          trim= trim.replaceAll("\t","");
          sb1.append(str.trim());
        }else{
          sb.append(str+"\r\n");
        }
//        sb.append(caseLine(str)+"\r\n");
      }
      startFlage = false;
      return sb.toString();
    } catch (FileNotFoundException e) {
      e.printStackTrace();
    } catch (IOException e) {
      e.printStackTrace();
    } finally {
      if (null != br){
        try {
          br.close();
        } catch (IOException e) {
          e.printStackTrace();
        }
      }
    }
    return null;
  }

  public static void outputFile(String str ,String filePath){
    BufferedWriter bw = null;
    try {
      File file = new File(filePath);
      if (!file.exists()){
        file.createNewFile();
      }
      bw = new BufferedWriter(new FileWriter(file));
      bw.write(str);
      bw.flush();
    } catch (IOException e) {
      e.printStackTrace();
    }finally {
      if (null != bw){
        try {
          bw.close();
        } catch (IOException e) {
          e.printStackTrace();
        }
      }
    }
  }

  public static void main(String[] args) {
   String inPath = "C:\\Users\\wafer\\Desktop\\templates";
   String outPath = "C:\\Users\\wafer\\Desktop\\templates-out";

   File inFile = new File(inPath);
   File inFiles [] = inFile.listFiles();
   for (File file: inFiles) {
    String str = caseFile(file);
    String fileName = file.getName();
    fileName = fileName.replace("vm","flt");
    outputFile(str,outPath+File.separator+fileName);
   }

//    caseElseIf("");


    System.out.println(System.currentTimeMillis());
  }

}
